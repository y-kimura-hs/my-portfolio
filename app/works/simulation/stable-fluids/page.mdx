{/*
---
title: "Realtime Stable Fluids"
date: "2023-12-10"
year: "2023"
category: "Simulation"
tags: ["WebGL", "Physics", "GLSL"]
description: "WebGL 2.0を用いたリアルタイム流体シミュレーション。Navier-Stokes方程式をGPU上で解き、煙のような挙動を再現しています。"
color: "from-blue-600 to-cyan-400"
---
*/}

import PageLayout from '@/components/layout/PageLayout'
import ViewCanvas from '@/components/canvas/ViewCanvas'
import Box from '@/components/canvas/Box'
import Particles from '@/components/canvas/Particles'
import Link from 'next/link'
import WorkNavigation from '@/components/works/WorkNavigation'

<PageLayout 
  title="Realtime Stable Fluids" 
  description="WebGL 2.0 / GLSL / Physics Simulation"
  tags={["WebGL", "Physics", "GLSL"]}
  tagBasePath="/works"
>

{/* --- デモセクション --- */}
<ViewCanvas>
  <Particles />
  <Box position={[0, 0, 0]} />
</ViewCanvas>


{/* --- 解説セクション --- */}
<div className="grid grid-cols-1 lg:grid-cols-[1fr_250px] gap-12 mt-12">
  
  <article>
    ## プロジェクト概要
    
    Jos Stam氏が1999年に発表した "Stable Fluids" アルゴリズムを、WebGL 2.0 (GPGPU) を用いてブラウザ上に実装しました。
    ナビエ・ストークス方程式を構成する「移流」「拡散」「外力」「圧力計算（発散除去）」の各項を、フラグメントシェーダーによるピングポンレンダリングで解いています。

    ### 技術的なポイント
    
    1. **Jacobi法による圧力計算**: 
       圧力場のポアソン方程式を解くために、反復法であるJacobi法を採用。フラグメントシェーダーで数十回反復させることで、非圧縮性流体の挙動を近似しています。
    
    2. **MacCormack法による移流**:
       単純なセミラグランジュ法では数値拡散によりディテールが失われやすいため、MacCormack法を導入して渦のディテールを維持しています。

    ### 実装コード（抜粋）
    
    移流項のシェーダーコードです。

    ```glsl
    uniform sampler2D velocity;
    uniform sampler2D source;
    uniform float dt;

    void main() {
        vec2 coord = gl_FragCoord.xy;
        // 速度場に従ってバックトレース
        vec2 pos = coord - dt * texture(velocity, uv).xy;
        // 補間して値をサンプリング
        gl_FragColor = texture(source, pos / resolution);
    }
    ```
  </article>

  <aside className="space-y-8">
    <div className="bg-card p-6 rounded-xl border border-border">
      <h3 className="font-bold text-txt-muted mb-4">Tech Stack</h3>
      <ul className="space-y-2 text-sm text-txt-muted">
        <li className="flex items-center"><span className="w-2 h-2 bg-blue-500 rounded-full mr-2"></span>Three.js</li>
        <li className="flex items-center"><span className="w-2 h-2 bg-purple-500 rounded-full mr-2"></span>GLSL</li>
        <li className="flex items-center"><span className="w-2 h-2 bg-green-500 rounded-full mr-2"></span>React Three Fiber</li>
      </ul>
    </div>
    
    <div className="bg-card p-6 rounded-xl border border-border">
      <h3 className="font-bold text-txt-muted mb-4">Links</h3>
      <a href="#" className="block text-primary hover:underline text-sm mb-2">View on GitHub ↗</a>
      <a href="#" className="block text-primary hover:underline text-sm">Paper Reference ↗</a>
    </div>
  </aside>

</div>

<WorkNavigation currentSlug="stable-fluids" />

</PageLayout>